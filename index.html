<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’• RP Hypertrophy Tracker ğŸ’•</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#ffe6f0;color:#330033;}
h1,h2,h3{text-align:center;margin:10px 0;}
.container{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;padding:10px;}
.card{background:#fff0f5;padding:16px;border-radius:16px;box-shadow:0 4px 10px rgba(255,182,193,0.4);flex:1 1 300px;max-width:400px;}
input,select,button{padding:8px;margin:4px 0;border-radius:12px;border:1px solid #ffb3d9;font-size:14px;}
button{cursor:pointer;background:#ff66b3;color:white;border:none;transition:0.2s;}
button:hover{background:#ff3399;}
button.secondary{background:#ffcccc;color:#330033;}
.exercise{padding:6px;border:1px dashed #ffb3d9;margin-bottom:6px;border-radius:8px;text-align:center;}
.tip{font-size:13px;color:#660066;margin:4px 0;display:none;}
.video{margin:6px 0;display:none;}
#xpBarContainer{background:#ffb3d9;border-radius:12px;width:100%;height:20px;margin-top:6px;}
#xpBar{background:#ff66b3;height:100%;width:0%;border-radius:12px;}
.badge{background:#ff99cc;color:#330033;border-radius:12px;padding:4px 8px;margin:4px 2px;display:inline-block;font-size:12px;}
#timerBarContainer{background:#ffb3d9;border-radius:12px;height:12px;width:100%;margin:4px 0;}
#timerBar{background:#ff66b3;height:100%;width:0%;border-radius:12px;}
#avatar{width:80px;height:80px;border-radius:50%;background:#ff66b3;margin:10px auto;}
#confettiCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;}
</style>
</head>
<body>
<h1>ğŸ’• RP Hypertrophy Tracker ğŸ’•</h1>
<div id="avatar"></div>
<canvas id="confettiCanvas"></canvas>

<div class="container">
  <div class="card">
    <h2>Workout Split ğŸ‹ï¸â€â™€ï¸</h2>
    <select id="split">
      <option value="fullbody">Full Body</option>
      <option value="pushpulllegs" selected>Push/Pull/Legs</option>
      <option value="upperlower">Upper/Lower</option>
      <option value="5day">5-Day Split</option>
      <option value="6day">6-Day Split</option>
    </select>
    <button id="setSplit">Set Split ğŸ’–</button>
    <div id="daySelectContainer" style="margin-top:10px;">
      <select id="daySelect"></select>
    </div>
  </div>

  <div class="card">
    <h2>Today's Workout ğŸ‹ï¸â€â™€ï¸</h2>
    <div id="exerciseContainer"></div>
    <button id="nextExercise">Next Exercise â¡ï¸</button>
    <div id="timerBarContainer"><div id="timerBar"></div></div>
    <div id="xpDisplay">XP: 0 | Level: 1</div>
    <div id="badges"></div>
    <canvas id="progressChart" width="300" height="200"></canvas>
    <div id="streakDisplay">ğŸ”¥ Streak: 0 days</div>
  </div>
</div>

<script>
// ---------------- Data ----------------
let workoutSplits={};let selectedDay="";
let workoutData=JSON.parse(localStorage.getItem("workouts")||"{}");
let xpData=JSON.parse(localStorage.getItem("xp")||"0");
let level=Math.floor(xpData/100)+1;
let badges=JSON.parse(localStorage.getItem("badges")||"[]");
let streak=JSON.parse(localStorage.getItem("streak")||0);
let lastWorkout=localStorage.getItem("lastWorkout");
let currentExerciseIndex=0;
let timerInterval;

const defaultExercises={
  push:[{name:"Bench Press",tip:"Feet flat, back slightly arched.",video:"https://www.youtube.com/embed/gRVjAtPip0Y"},{name:"Overhead Press",tip:"Press straight overhead.",video:"https://www.youtube.com/embed/qEwKCR5JCog"}],
  pull:[{name:"Pull-ups",tip:"Full range motion.",video:"https://www.youtube.com/embed/eGo4IYlbE5g"},{name:"Barbell Row",tip:"Keep back flat.",video:"https://www.youtube.com/embed/vT2GjY_Umpw"}],
  legs:[{name:"Squat",tip:"Chest up, knees tracking toes.",video:"https://www.youtube.com/embed/aclHkVaku9U"},{name:"Deadlift",tip:"Flat back, lift with legs/hips.",video:"https://www.youtube.com/embed/ytGaGIn3SjE"}],
  full:[{name:"Squat",tip:"Chest up.",video:"https://www.youtube.com/embed/aclHkVaku9U"},{name:"Bench Press",tip:"Feet flat.",video:"https://www.youtube.com/embed/gRVjAtPip0Y"}]
};

// ---------------- Functions ----------------
function setSplit(){
  const split=document.getElementById("split").value;
  workoutSplits={};
  if(split==="pushpulllegs") workoutSplits={Day1:"push",Day2:"pull",Day3:"legs",Day4:"push",Day5:"pull",Day6:"legs"};
  else if(split==="upperlower") workoutSplits={Day1:"upper",Day2:"lower",Day3:"upper",Day4:"lower"};
  else if(split==="fullbody") workoutSplits={Day1:"full",Day2:"full",Day3:"full"};
  else if(split==="5day") workoutSplits={Day1:"push",Day2:"pull",Day3:"legs",Day4:"push",Day5:"pull"};
  else if(split==="6day") workoutSplits={Day1:"push",Day2:"pull",Day3:"legs",Day4:"push",Day5:"pull",Day6:"legs"};
  renderDays();
}

function renderDays(){
  const daySelect=document.getElementById("daySelect");
  daySelect.innerHTML="";
  for(const day in workoutSplits){
    const opt=document.createElement("option");
    opt.value=day; opt.textContent=day; daySelect.appendChild(opt);
  }
  selectedDay=daySelect.value;
  currentExerciseIndex=0;
  renderExercise();
}

document.getElementById("daySelect").onchange=()=>{
  selectedDay=document.getElementById("daySelect").value;
  currentExerciseIndex=0;
  renderExercise();
};

function renderExercise(){
  clearInterval(timerInterval);
  document.getElementById("timerBar").style.width="0%";
  const container=document.getElementById("exerciseContainer");
  container.innerHTML="";
  const type=workoutSplits[selectedDay];
  const exercises=defaultExercises[type]||[];
  if(currentExerciseIndex>=exercises.length){
    container.innerHTML="<h3>Workout Complete! ğŸ’–</h3>";
    addXP(50); addBadge("Completed "+selectedDay); updateStreak(); renderChart(); celebrate();
    return;
  }
  const ex=exercises[currentExerciseIndex];
  const div=document.createElement("div");
  div.className="exercise";
  div.innerHTML=`<strong>${ex.name}</strong><br>
    Sets: <input type="number" value="3" style="width:50px;"> 
    Reps: <input type="number" value="10" style="width:50px;"> 
    Weight: <input type="number" value="" style="width:60px;"><br>
    <button class="tipBtn secondary">Show Tip ğŸ’¡</button>
    <div class="tip">${ex.tip}</div>
    <div class="video"><iframe width="280" height="157" src="${ex.video}" frameborder="0" allowfullscreen></iframe></div>`;
  container.appendChild(div);
  div.querySelector(".tipBtn").onclick=()=>{
    const tip=div.querySelector(".tip"); const video=div.querySelector(".video");
    tip.style.display=tip.style.display==="none"?"block":"none";
    video.style.display=video.style.display==="none"?"block":"block";
  };
  startRestTimer(60);
}

function saveExercise(){
  const container=document.getElementById("exerciseContainer");
  const exDiv=container.querySelector(".exercise");
  if(!exDiv) return;
  if(!workoutData[selectedDay]) workoutData[selectedDay]=[];
  workoutData[selectedDay].push({
    name: exDiv.querySelector("strong").textContent,
    sets:+exDiv.querySelector("input[type=number]").value,
    reps:+exDiv.querySelectorAll("input[type=number]")[1].value,
    weight:+exDiv.querySelectorAll("input[type=number]")[2].value
  });
  localStorage.setItem("workouts",JSON.stringify(workoutData));
}

function addXP(amount){
  xpData+=amount; localStorage.setItem("xp",xpData);
  level=Math.floor(xpData/100)+1;
  document.getElementById("xpDisplay").textContent=`XP: ${xpData} | Level: ${level}`;
  updateAvatar();
}

function addBadge(name){
  if(!badges.includes(name)){ badges.push(name); localStorage.setItem("badges",JSON.stringify(badges)); renderBadges(); celebrate(); }
}

function renderBadges(){
  const bDiv=document.getElementById("badges"); bDiv.innerHTML="";
  badges.forEach(b=>{ const span=document.createElement("span"); span.className="badge"; span.textContent=b; bDiv.appendChild(span); });
}
renderBadges();

function renderChart(){
  const ctx=document.getElementById("progressChart").getContext("2d");
  const dayLabels=[]; const dayWeights=[];
  for(const day in workoutData){
    const w=workoutData[day].map(e=>e.weight||0);
    const avg=w.length?w.reduce((a,b)=>a+b,0)/w.length:0;
    dayLabels.push(day); dayWeights.push(avg);
  }
  if(window.myChart) window.myChart.destroy();
  window.myChart=new Chart(ctx,{
    type:'line',
    data:{labels:dayLabels,datasets:[{label:"Avg Weight (lbs)",data:dayWeights,borderColor:"#ff66b3",backgroundColor:"#ffcce6",fill:true,tension:0.3}]},
    options:{responsive:true,plugins:{legend:{display:true}}}
  });
}

// ---------------- Avatar ----------------
function updateAvatar(){
  const avatar=document.getElementById("avatar");
  avatar.style.background=`linear-gradient(135deg,#ff66b3 ${level*10}%,#ffb3d9)`;
}

// ---------------- Streak ----------------
function updateStreak(){
  const today=new Date().toDateString();
  if(lastWorkout!==today){
    const yesterday=new Date(); yesterday.setDate(yesterday.getDate()-1);
    streak=(lastWorkout===yesterday.toDateString())?streak+1:1;
    localStorage.setItem("streak",streak); localStorage.setItem("lastWorkout",today);
    document.getElementById("streakDisplay").textContent=`ğŸ”¥ Streak: ${streak} days`;
  }
}

// ---------------- Confetti ----------------
function celebrate(){
  const canvas=document.getElementById("confettiCanvas");
  const ctx=canvas.getContext("2d");
  canvas.width=window.innerWidth; canvas.height=window.innerHeight;
  const confetti=[]; for(let i=0;i<100;i++){ confetti.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,dx:(Math.random()-0.5)*5,dy:Math.random()*5+2,r:Math.random()*6+2})}
  let frame=0; function draw(){ ctx.clearRect(0,0,canvas.width,canvas.height); confetti.forEach(c=>{ ctx.fillStyle="#ff66b3"; ctx.beginPath(); ctx.arc(c.x,c.y,c.r,0,Math.PI*2); ctx.fill(); c.x+=c.dx; c.y+=c.dy; if(c.y>canvas.height)c.y=0; if(c.x>canvas.width)c.x=0;if(c.x<0)c.x=canvas.width; }); frame++; if(frame<200) requestAnimationFrame(draw); } draw();
}

// ---------------- Rest Timer ----------------
function startRestTimer(seconds){
  let elapsed=0;
  const bar=document.getElementById("timerBar");
  timerInterval=setInterval(()=>{
    elapsed++; let pct=(elapsed/seconds)*100; bar.style.width=pct+"%";
    if(elapsed>=seconds){ clearInterval(timerInterval); bar.style.width="0%"; }
  },1000);
}

// ---------------- Next Exercise ----------------
document.getElementById("nextExercise").onclick=()=>{
  saveExercise(); currentExerciseIndex++; renderExercise();
};
document.getElementById("setSplit").onclick=setSplit;
setSplit();
updateAvatar();
document.getElementById("streakDisplay").textContent=`ğŸ”¥ Streak: ${streak} days`;
</script>
</body>
</html>
